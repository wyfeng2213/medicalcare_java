<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cmcc.medicalcare.model.Orders">
  <resultMap id="BaseResultMap" type="com.cmcc.medicalcare.model.Orders">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="id" jdbcType="INTEGER" property="id" />
    <result column="orders_title" jdbcType="VARCHAR" property="ordersTitle" />
    <result column="symptom" jdbcType="VARCHAR" property="symptom" />
    <result column="requirement" jdbcType="VARCHAR" property="requirement" />
    <result column="diagnose_time" jdbcType="VARCHAR" property="diagnoseTime" />
    <result column="image_url" jdbcType="VARCHAR" property="imageUrl" />
    <result column="orders_price" jdbcType="VARCHAR" property="ordersPrice" />
    <result column="orders_type" jdbcType="INTEGER" property="ordersType" />
    <result column="prescription_id" property="prescriptionId" jdbcType="INTEGER" />
    <result column="pay_type" jdbcType="INTEGER" property="payType" />
    <result column="orders_pay_state" jdbcType="INTEGER" property="ordersPayState" />
    <result column="paytime" jdbcType="TIMESTAMP" property="paytime" />
    <result column="orders_state" jdbcType="INTEGER" property="ordersState" />
    <result column="patient_login_id" jdbcType="VARCHAR" property="patientLoginId" />
    <result column="patient_name" jdbcType="VARCHAR" property="patientName" />
    <result column="patient_phone" jdbcType="VARCHAR" property="patientPhone" />
    <result column="doctor_login_id" jdbcType="VARCHAR" property="doctorLoginId" />
    <result column="doctor_name" jdbcType="VARCHAR" property="doctorName" />
    <result column="doctor_phone" jdbcType="VARCHAR" property="doctorPhone" />
    <result column="order_no" jdbcType="VARCHAR" property="orderNo" />
    <result column="pay_order_no" jdbcType="VARCHAR" property="payOrderNo" />
    <result column="createtime" jdbcType="TIMESTAMP" property="createtime" />
    <result column="updatetime" jdbcType="TIMESTAMP" property="updatetime" />
  </resultMap>
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    id, orders_title, symptom, requirement, diagnose_time, image_url, orders_price, orders_type, 
    prescription_id,pay_type, orders_pay_state, paytime, orders_state, patient_login_id, patient_name, patient_phone, 
    doctor_login_id, doctor_name, doctor_phone, order_no, pay_order_no, createtime, updatetime
  </sql>
  <select id="selectByPrimaryKey" parameterType="java.lang.Integer" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select 
    <include refid="Base_Column_List" />
    from orders
    where id = #{id,jdbcType=INTEGER}
  </select>
  
  <select id="getUnfinishedOrders" parameterType="java.lang.String" resultMap="BaseResultMap">
    select 
    <include refid="Base_Column_List" />
    from orders
    where orders_type=5 and orders_state=0 and doctor_login_id = #{doctorLoginId,jdbcType=VARCHAR}
  </select>
  
  <select id="getUnfinishedOrders2" parameterType="java.util.Map" resultMap="BaseResultMap">
    select 
    <include refid="Base_Column_List" />
    from orders
    where orders_type=5 and orders_state=0 
		<if test="doctorLoginId != null and doctorLoginId !='' ">
			and doctor_login_id = #{doctorLoginId,jdbcType=VARCHAR}
		</if>
		<if test="patientLoginId != null and patientLoginId !='' ">
			and patient_login_id = #{patientLoginId,jdbcType=VARCHAR}
		</if>
  </select>
  
  <select id="selectByPatientPhone" parameterType="java.util.Map" resultMap="BaseResultMap">
    select 
    <include refid="Base_Column_List" />
    from orders
    where patient_phone = #{patientPhone,jdbcType=VARCHAR} 
    	and (orders_type=3 or orders_type=5 or orders_type=6) 
  </select>
  
  <select id="selectDoctorsOrders" parameterType="java.util.Map" resultMap="BaseResultMap">
    select 
    <include refid="Base_Column_List" />
    from orders
    where 1=1
    <if test="hospital != null and hospital !=''">
    	AND doctor_login_id in (select distinct login_id from doctors_user where hospital=#{hospital,jdbcType=VARCHAR})
    </if>
    <if test="doctorName != null and doctorName !=''">
    	AND doctor_name like CONCAT(CONCAT('%',#{doctorName}),'%')
    </if>
  </select>
  
  <select id="selectByOrderNo" parameterType="java.lang.String" resultMap="BaseResultMap">
    select 
    <include refid="Base_Column_List" />
    from orders
    where order_no = #{orderNo,jdbcType=VARCHAR}
  </select>
  
  <select id="selectByPrescriptionId" parameterType="java.lang.Integer" resultMap="BaseResultMap">
    select 
    <include refid="Base_Column_List" />
    from orders
    where prescription_id = #{prescriptionId,jdbcType=INTEGER}
  </select>
  
  <select id="selectGraphicOrders" parameterType="java.util.Map" resultMap="BaseResultMap">
    select 
    <include refid="Base_Column_List" />
    from orders
    where orders_type=3 and orders_pay_state=1 and patient_phone=#{patientPhone,jdbcType=VARCHAR} 
    	and doctor_phone=#{doctorPhone,jdbcType=VARCHAR}
    order by id desc limit 1
  </select>
  
  <select id="selectVideoOrders" parameterType="java.util.Map" resultMap="BaseResultMap">
    select 
    <include refid="Base_Column_List" />
    from orders
    where orders_type=5 and orders_pay_state=1 and patient_phone=#{patientPhone,jdbcType=VARCHAR} 
    	and doctor_phone=#{doctorPhone,jdbcType=VARCHAR}
    order by id desc limit 1
  </select>
  
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from orders
    where id = #{id,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="com.cmcc.medicalcare.model.Orders" useGeneratedKeys="true" keyProperty="id">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into orders (id, orders_title, symptom, 
      requirement, diagnose_time, image_url, 
      orders_price, orders_type, prescription_id, 
      pay_type, orders_pay_state, paytime, orders_state, 
      patient_login_id, patient_name, patient_phone, 
      doctor_login_id, doctor_name, doctor_phone, 
      order_no, pay_order_no, createtime, updatetime
      )
    values (#{id,jdbcType=INTEGER}, #{ordersTitle,jdbcType=VARCHAR}, #{symptom,jdbcType=VARCHAR}, 
      #{requirement,jdbcType=VARCHAR}, #{diagnoseTime,jdbcType=VARCHAR}, #{imageUrl,jdbcType=VARCHAR}, 
      #{ordersPrice,jdbcType=VARCHAR}, #{ordersType,jdbcType=INTEGER}, #{prescriptionId,jdbcType=INTEGER}, 
      #{payType,jdbcType=INTEGER}, #{ordersPayState,jdbcType=INTEGER}, #{paytime,jdbcType=TIMESTAMP}, #{ordersState,jdbcType=INTEGER}, 
      #{patientLoginId,jdbcType=VARCHAR}, #{patientName,jdbcType=VARCHAR}, #{patientPhone,jdbcType=VARCHAR}, 
      #{doctorLoginId,jdbcType=VARCHAR}, #{doctorName,jdbcType=VARCHAR}, #{doctorPhone,jdbcType=VARCHAR}, 
      #{orderNo,jdbcType=VARCHAR}, #{payOrderNo,jdbcType=VARCHAR}, #{createtime,jdbcType=TIMESTAMP}, #{updatetime,jdbcType=TIMESTAMP}
      )
  </insert>
  <insert id="insertSelective" parameterType="com.cmcc.medicalcare.model.Orders" useGeneratedKeys="true" keyProperty="id">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into orders
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        id,
      </if>
      <if test="ordersTitle != null" >
        orders_title,
      </if>
      <if test="symptom != null" >
        symptom,
      </if>
      <if test="requirement != null" >
        requirement,
      </if>
      <if test="diagnoseTime != null" >
        diagnose_time,
      </if>
      <if test="imageUrl != null" >
        image_url,
      </if>
      <if test="ordersPrice != null" >
        orders_price,
      </if>
      <if test="ordersType != null" >
        orders_type,
      </if>
      <if test="prescriptionId != null" >
        prescription_id,
      </if>
      <if test="payType != null" >
        pay_type,
      </if>
      <if test="ordersPayState != null" >
        orders_pay_state,
      </if>
      <if test="paytime != null" >
        paytime,
      </if>
      <if test="ordersState != null" >
        orders_state,
      </if>
      <if test="patientLoginId != null" >
        patient_login_id,
      </if>
      <if test="patientName != null" >
        patient_name,
      </if>
      <if test="patientPhone != null" >
        patient_phone,
      </if>
      <if test="doctorLoginId != null" >
        doctor_login_id,
      </if>
      <if test="doctorName != null" >
        doctor_name,
      </if>
      <if test="doctorPhone != null" >
        doctor_phone,
      </if>
      <if test="orderNo != null" >
        order_no,
      </if>
      <if test="payOrderNo != null" >
        pay_order_no,
      </if>
      <if test="createtime != null" >
        createtime,
      </if>
      <if test="updatetime != null" >
        updatetime,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        #{id,jdbcType=INTEGER},
      </if>
      <if test="ordersTitle != null" >
        #{ordersTitle,jdbcType=VARCHAR},
      </if>
      <if test="symptom != null" >
        #{symptom,jdbcType=VARCHAR},
      </if>
      <if test="requirement != null" >
        #{requirement,jdbcType=VARCHAR},
      </if>
      <if test="diagnoseTime != null" >
        #{diagnoseTime,jdbcType=VARCHAR},
      </if>
      <if test="imageUrl != null" >
        #{imageUrl,jdbcType=VARCHAR},
      </if>
      <if test="ordersPrice != null" >
        #{ordersPrice,jdbcType=VARCHAR},
      </if>
      <if test="ordersType != null" >
        #{ordersType,jdbcType=INTEGER},
      </if>
      <if test="prescriptionId != null" >
        #{prescriptionId,jdbcType=INTEGER},
      </if>
      <if test="payType != null" >
        #{payType,jdbcType=INTEGER},
      </if>
      <if test="ordersPayState != null" >
        #{ordersPayState,jdbcType=INTEGER},
      </if>
      <if test="paytime != null" >
        #{paytime,jdbcType=TIMESTAMP},
      </if>
      <if test="ordersState != null" >
        #{ordersState,jdbcType=INTEGER},
      </if>
      <if test="patientLoginId != null" >
        #{patientLoginId,jdbcType=VARCHAR},
      </if>
      <if test="patientName != null" >
        #{patientName,jdbcType=VARCHAR},
      </if>
      <if test="patientPhone != null" >
        #{patientPhone,jdbcType=VARCHAR},
      </if>
      <if test="doctorLoginId != null" >
        #{doctorLoginId,jdbcType=VARCHAR},
      </if>
      <if test="doctorName != null" >
        #{doctorName,jdbcType=VARCHAR},
      </if>
      <if test="doctorPhone != null" >
        #{doctorPhone,jdbcType=VARCHAR},
      </if>
      <if test="orderNo != null" >
        #{orderNo,jdbcType=VARCHAR},
      </if>
      <if test="payOrderNo != null" >
        #{payOrderNo,jdbcType=VARCHAR},
      </if>
      <if test="createtime != null" >
        #{createtime,jdbcType=TIMESTAMP},
      </if>
      <if test="updatetime != null" >
        #{updatetime,jdbcType=TIMESTAMP},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.cmcc.medicalcare.model.Orders">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update orders
    <set >
      <if test="ordersTitle != null" >
        orders_title = #{ordersTitle,jdbcType=VARCHAR},
      </if>
      <if test="symptom != null" >
        symptom = #{symptom,jdbcType=VARCHAR},
      </if>
      <if test="requirement != null" >
        requirement = #{requirement,jdbcType=VARCHAR},
      </if>
      <if test="diagnoseTime != null" >
        diagnose_time = #{diagnoseTime,jdbcType=VARCHAR},
      </if>
      <if test="imageUrl != null" >
        image_url = #{imageUrl,jdbcType=VARCHAR},
      </if>
      <if test="ordersPrice != null" >
        orders_price = #{ordersPrice,jdbcType=VARCHAR},
      </if>
      <if test="ordersType != null" >
        orders_type = #{ordersType,jdbcType=INTEGER},
      </if>
      <if test="prescriptionId != null" >
        prescription_id = #{prescriptionId,jdbcType=INTEGER},
      </if>
      <if test="payType != null" >
        pay_type = #{payType,jdbcType=INTEGER},
      </if>
      <if test="ordersPayState != null" >
        orders_pay_state = #{ordersPayState,jdbcType=INTEGER},
      </if>
      <if test="paytime != null" >
        paytime = #{paytime,jdbcType=TIMESTAMP},
      </if>
      <if test="ordersState != null" >
        orders_state = #{ordersState,jdbcType=INTEGER},
      </if>
      <if test="patientLoginId != null" >
        patient_login_id = #{patientLoginId,jdbcType=VARCHAR},
      </if>
      <if test="patientName != null" >
        patient_name = #{patientName,jdbcType=VARCHAR},
      </if>
      <if test="patientPhone != null" >
        patient_phone = #{patientPhone,jdbcType=VARCHAR},
      </if>
      <if test="doctorLoginId != null" >
        doctor_login_id = #{doctorLoginId,jdbcType=VARCHAR},
      </if>
      <if test="doctorName != null" >
        doctor_name = #{doctorName,jdbcType=VARCHAR},
      </if>
      <if test="doctorPhone != null" >
        doctor_phone = #{doctorPhone,jdbcType=VARCHAR},
      </if>
      <if test="orderNo != null" >
        order_no = #{orderNo,jdbcType=VARCHAR},
      </if>
      <if test="payOrderNo != null" >
        pay_order_no = #{payOrderNo,jdbcType=VARCHAR},
      </if>
      <if test="createtime != null" >
        createtime = #{createtime,jdbcType=TIMESTAMP},
      </if>
      <if test="updatetime != null" >
        updatetime = #{updatetime,jdbcType=TIMESTAMP},
      </if>
    </set>
    where id = #{id,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.cmcc.medicalcare.model.Orders" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update orders
    set orders_title = #{ordersTitle,jdbcType=VARCHAR},
      symptom = #{symptom,jdbcType=VARCHAR},
      requirement = #{requirement,jdbcType=VARCHAR},
      diagnose_time = #{diagnoseTime,jdbcType=VARCHAR},
      image_url = #{imageUrl,jdbcType=VARCHAR},
      orders_price = #{ordersPrice,jdbcType=VARCHAR},
      orders_type = #{ordersType,jdbcType=INTEGER},
      prescription_id = #{prescriptionId,jdbcType=INTEGER},
      pay_type = #{payType,jdbcType=INTEGER},
      orders_pay_state = #{ordersPayState,jdbcType=INTEGER},
      paytime = #{paytime,jdbcType=TIMESTAMP},
      orders_state = #{ordersState,jdbcType=INTEGER},
      patient_login_id = #{patientLoginId,jdbcType=VARCHAR},
      patient_name = #{patientName,jdbcType=VARCHAR},
      patient_phone = #{patientPhone,jdbcType=VARCHAR},
      doctor_login_id = #{doctorLoginId,jdbcType=VARCHAR},
      doctor_name = #{doctorName,jdbcType=VARCHAR},
      doctor_phone = #{doctorPhone,jdbcType=VARCHAR},
      order_no = #{orderNo,jdbcType=VARCHAR},
      pay_order_no = #{payOrderNo,jdbcType=VARCHAR},
      createtime = #{createtime,jdbcType=TIMESTAMP},
      updatetime = #{updatetime,jdbcType=TIMESTAMP}
    where id = #{id,jdbcType=INTEGER}
  </update>
</mapper>